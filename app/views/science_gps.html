<div id="gc" class="container">

  <div class="row">

    <div class="col-lg-12">
      <h1 class="page-header">GPS Maths
                <small></small>
            </h1>
      <ol class="breadcrumb">
        <li><a href="../index.html">scienceflow</a>
        </li>
        <li><a href="#/science">Science</a>
        </li>
        <li class="active">GPS Maths</li>
      </ol>
    </div>

  </div>
  <div class="section">
    <div class="container">

      <div class="row">
        <div class="col-lg-6 col-md-6">
          <h3>Coordinate Systems</h3>
          <p class="par-text">
            GPS positioning is an approach to identify the position of a receiver by time and range signals received from satellites. There are two coordinate systems that are widely used in this field. The first one is Earth-Centered-Earth-Fixed (ECEF) which spans a standard carthesian coordinate system with the center of the earth as zero. The axis go through the Greenwich meridian, the ellipsoidal meridian and the south pole. Another, more common, way to express the position is relative the earth surface which is also known as the Local-Geodic-Corrdinate-System. The position is expressed as latitude, longitude and height. The position is usually calculated as ECEF coordinates and then projected to the coordinates most people are used to.
          </p>
          <p class="par-text">
            The images were generated by some tool, I wrote in 2004 or by Mathematica.
          </p>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-6">
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/earth.png" />
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="section-colored">
    <div class="container">

      <div class="row">

        <div class="col-lg-4 col-md-4 col-sm-6">
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/bubble.png" />
          </a>
          <br>
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/trace.png" />
          </a>
        </div>
        <div class="col-lg-6 col-md-6">
          <h3>Position Equation</h3>
          <p class="par-text">
            ECEF coordinates have four dimensions $(x,y,z,t)$. $t$ is the clock error. When starting the calculation a position is guessed. This is usually based on the last known position or $(0,0,0,0)$ initially. From the received satellite position, the pseudorange can be calculated. $$\hat{\rho}_{sat}=|r_{sat}-r_{user}|-cb_{user}$$ $cb_{user}$ is the speed of light multiplied by the clock error. Now, the line of sight is calculated which represents the cosine values between the user position and the satellite position. $$\hat{l}_{sat}=\frac{r_{sat}-r_{user}}{|r_{sat}-r_{user}|}$$ The matrix $G$ is created from the line of sight values and 1 for the clock error. Afterwards, the range error is determined. $$\Delta\rho=\rho_{sat}-\rho_{meas}$$ Now, the error of the initial position guessing can be approximated. $$\Delta x=[G^{T}R^{-1}G]^{-1}G^{T}R^{-1}\Delta\rho$$ $R$ is the covariance matrix from the satellites standard deviation values. It can also be disregarded which leads to. $$\Delta x=[G^{T}G]^{-1}G^{T}\Delta\rho$$ A new position estimate can be calculated. $$\hat{x}_{new}=x_{est} - \Delta x$$ The algorithm can be repeated with the new estimate. It should terminate when the new and the old estimate are close to equal. Afterwards, the accuracy matrix can be determined. $$A=[G^{T}R^{-1}G]^{-1}$$ or without $R$ present: $$A=[G^{T}G]^{-1}$$ The Dilusion of Precision (DOP) gives an impression of the dimension dependent accuracy.
            <br> Total: $GDOP = \sqrt{trace(A)}$
            <br> Position: $PDOP = \sqrt{A_{1,1}+A_{2,2}+A_{3,3}}$
            <br> Horizontal: $PDOP = \sqrt{A_{1,1}+A_{2,2}}$
            <br> Vertical: $VDOP = \sqrt{A_{3,3}}$
            <br> Time: $TDOP = \sqrt{A_{4,4}}$
          </p>
        </div>
      </div>
    </div>

  </div>
  <div class="section">
    <div class="container">

      <div class="row">
        <div class="col-lg-6 col-md-6">
          <h3>Derivation by Regression</h3>
          <p class="par-text">
            The first way to derive the navigation equation is by ordinary least squares estimation. The residual $e=\hat{y}_{i}-y_{i}$ shall be minimized. Fundamental equation ($\varepsilon$: error, $g_{i,j}$: value in $G$ cos of angle, $c$: speed of light, $b$: clock error): $$\rho_{i}=g_{i,1}x+g_{i,2}y+g_{i,3}z+c*b+\varepsilon$$ For easier matrix notation: $$\rho_{i}=g_{i,0}c*b+g_{i,1}x+g_{i,2}y+g_{i,3}z+\varepsilon\quad g_{i,0}=1$$ Example for $i=5$: $$G = \begin{pmatrix} g_{1,1} & g_{1,2} & \cdots & g_{1,5} \\ g_{2,1} & g_{2,2} & \cdots & g_{2,5} \\ \vdots & \vdots & \ddots & \vdots \\ g_{5,1} & g_{5,2} & \cdots & g_{5,5} \end{pmatrix}$$ $$\rho=\begin{pmatrix} \rho_{1} \\ \rho_{2} \\ \rho_{3} \\ \rho_{4} \end{pmatrix}\quad \hat{x}=\begin{pmatrix} x \\ y \\ z \\ c*b \end{pmatrix}\quad \varepsilon=\begin{pmatrix} \varepsilon{1} \\ \varepsilon{2} \\ \varepsilon{3} \\ \varepsilon{4} \end{pmatrix}$$ This leads to $\rho=G\hat{x} + \varepsilon$. Estimated regression line: $$\Delta\rho_{i}=c*\Delta b+g_{i,1}\Delta x+g_{i,2}\Delta y+g_{i,3}\Delta z+e_{i}$$ $$\Delta\rho_{c}=c*\Delta b+g_{i,1}\Delta x+g_{i,2}\Delta y+g_{i,3}\Delta z$$ Normal equations: $$\sum_{i=0}^N{c*\Delta b+g_{i,1}\Delta x+g_{i,2}\Delta y+g_{i,3}\Delta z}=\Sigma\rho$$ $$\sum_{i=0}^N{g_{i,1}c*\Delta b+g_{i,1}g_{i,1}\Delta x+g_{i,1}g_{i,2}\Delta y+g_{i,1}g_{i,3}\Delta z}=\Sigma g_{i}\rho$$ $\cdots$
            <br> In matrix notation $\Delta\rho=G\Delta\hat{x}+e$ $$G = \begin{pmatrix} n & \Sigma g_{1} & \Sigma g_{2} & \Sigma g_{3} \\ \Sigma g_{1} & \Sigma g_{1}^{2} & \Sigma g_{1}g{2} & \Sigma g_{1}g{3} \\ \Sigma g_{2} & \Sigma g_{2}g{1} & \Sigma g_{2}^{2} & \Sigma g_{2}g{3} \\ \Sigma g_{3} & \Sigma g_{3}g{1} & \Sigma g_{3}g{2} & \Sigma g_{3}^{2} \end{pmatrix}\begin{pmatrix} c*\Delta b \\ \Delta x \\ \Delta y \\ \Delta z \end{pmatrix}=\begin{pmatrix} \Sigma\rho \\ \Sigma g_{1}\rho \\ \Sigma g_{2}\rho \\ \Sigma g_{3}\rho \end{pmatrix}$$ To get the normal equation set $GG^{T}\Delta x=G^{T}\Delta \rho$. You can check this relation by multiplying. The regression coefficents are then $\Delta x=(GG^{T})^{-1}G^{T}\Delta \rho$, which is the position estimate for the GPS coordinates.
          </p>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-6">
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/inview.png" />
          </a>
          <br>
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/tdradar.png" />
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="section-colored">
    <div class="container">

      <div class="row">
        <div class="col-lg-4 col-md-4 col-sm-6">
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/radar.png" />
          </a>
        </div>
        <div class="col-lg-6 col-md-6">
          <h3>Derivation by Residues</h3>
          <p class="par-text">
            The sum of quadrated residuals $e=\hat{y}_{i}-y_{i}$ shall be minimized. In matrix notation this is $e^{T}e$. $$e^{T}e=(\Delta\rho-G\Delta \hat{x})^{T}(\Delta\rho-G\Delta\hat{x})$$ $$=\Delta\rho^{T}\Delta\rho - \Delta\rho^{T}(G\Delta \hat{x})-(G\Delta \hat{x})^{T}\Delta\rho+(G\Delta \hat{x})^{T}(G\Delta \hat{x})$$ with $(G\Delta \hat{x})^{T}=\Delta\hat{x}^{T}G^{T}$ and $\Delta\hat{x}^{T}G^{T}\Delta\rho= \Delta\rho^{T}G\Delta\hat{x}$ $$=\Delta\rho^{T}\Delta\rho - 2\Delta\hat{x}^{T}G^{T}\Delta\rho+\Delta\hat{x}^{T}G^{T}G\Delta\hat{x}$$ For finding the minimum differentiate $\Delta\hat{x}$ $-2G^{T}\Delta\rho+2G^{T}G\Delta\hat{x}=0\quad\Rightarrow\quad\Delta x=(GG^{T})^{-1}G^{T}\Delta \rho$
          </p>
        </div>

      </div>
    </div>

  </div>
  <div class="section">
    <div class="container">

      <div class="row">
        <div class="col-lg-6 col-md-6">
          <h3>Covariance Matrix</h3>
          <p class="par-text">
            The regression analysis before made the assumption that the measurement values are uncorrelated. If the values are correlated, the error induced by correlation should not be neglected. Therefore, the covariance matrix must be induced to the calculation. The inverse of the covariance matrix is the weight matrix. $$R = Var - Cov(\hat{x})= \begin{pmatrix} Var(X_{0}) & Cov(X_{0}X_{1}) & \cdots & Cov(X_{0}X_{m}) \\ Cov(X_{1}X_{0}) & Var(X_{1}) & \cdots & Cov(X_{1}X_{m}) \\ \vdots & \vdots & \ddots & \vdots \\ Cov(X_{m}X_{0}) & Cov(X_{m}X_{1}) & \cdots & Var(X_{m}) \end{pmatrix}$$ $$Var(X_{i})=E[X_{i}-E(X_{i})]^2=E[X_{i}-E(X_{i})]*E[X_{i}-E(X_{i})]^{T}$$ $$Cov(X_{a},X_{b})=E[X_{a}-E(X_{a})]*E[X_{b}-E(X_{b})]$$ Correlation coefficient: $r(X_{a},X_{b})=\frac{Cov(X_{a},X_{b})}{\sqrt{Var(X_{a})}*\sqrt{Var(X_{b})}}$ $$e^{T}e=(\Delta\rho-G\Delta \hat{x})^{T}R^{-1}(\Delta\rho-G\Delta\hat{x})$$ The derivation of this formula leads to: $\Delta x=(GR^{-1}G^{T})^{-1}G^{T}R^{-1}\Delta \rho$ The error in the covariance matrix is: $$\Sigma=E[(d\hat{x}-dx)(d\hat{x}-dx)^{T}] = (GR^{-1}G^{T})^{-1}$$ For the special case $R=\sigma^{2}I$ ($I$ is the identity matrix) $\Sigma=\sigma^{2}(G^{T}G)^{-1}$
          </p>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-6">
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <br>
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/deviation.png" />
          </a>
        </div>
      </div>
    </div>
  </div>
  <div class="section-colored">
    <div class="container">

      <div class="row">
        <div class="col-lg-4 col-md-4 col-sm-6">
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/thres.png" />
          </a>Correlation error
          <br>
          <br>
          <br>
          <a>
            <img class="img-responsive img-home-portfolio blog-img" src="images/wsse.png" />
          </a>
          WSSE error
        </div>
        <div class="col-lg-6 col-md-6">
          <h3>RAIM Algorithms</h3>
          <p class="par-text">
            Receiver Autonomous Integritiy Monitoring (RAIM) is a technique to find corrupt satellite data. Signal reflection or defective satellites may cause corrupted pseudorange measurements or clock deviation. RAIM algorithms can be tested easily by adding an error to the received pseudorange of an arbitrary satellite. In the following, two RAIM algorithms will be provided.
          </p>
          <p class="par-text">
            The <a href="http://www.ion.org/publications/abstract.cfm?articleID=5256">first one</a> starts with the residual vectors $r=\Delta\rho-G\Delta x$ and the sensitivity matrix $S=I-G(GR^{-1}G^{T})^{-1}G^{T}R^{-1}$ where $I$ is the identity matrix. Calculate the root mean square $\delta=\sqrt{\frac{r^{T}r}{n}}$. Correlate every column of $S$ ($n$ is the number of satellites) with the residual vector. $$c_{j}=\frac{\sum_{i=1}^n r_{i}S_{i,j}}{|r_{j}| |S_{j}|}$$ $c_{j}$ is the correlation coefficient for every satellite. The closer it is to -1 or 1, the higher the probability for an error of the respective satellite. The threshold for detecting an error must be set beforehand. $|r_{j}|=\delta\sqrt{n}$ and $|S_{j}|= \sqrt{S_{j,j}}$. The size of the pseudorange error can be calculated by $e_{j}=\frac{\delta\sqrt{n}} {\sqrt{S_{j,j}}}$. If an error was detected, the residuals have to be calculated again by $r_{new} = r + S_{j}e_{j}$.
          </p>
          <p class="par-text">
            The <a href="http://waas.stanford.edu/papers/Walter_IONGPS_1995_wraim.pdf">second algorithm</a> detects much smaller error than the first one but trades this advantage for a higher computation complexity. The algorithm uses the Weighted Sum of Squared Errors (WSSE) which are compared to a threshold. The position solution is calculated for every set of satellites with one satellite missing. Calculate $WSSE=\Delta\rho^{T}R^{-1}S\Delta\rho$ for every solution. $S$ is the sensitivity matrix $S=I-G(GR^{-1}G^{T})^{-1}G^{T}R^{-1}$. Threshold values for different sensitivity classes are in the paper.
          </p>
        </div>

      </div>
    </div>

  </div>
  <!-- /.container -->